import{f,a as m}from"../chunks/CsXgwlOL.js";import"../chunks/BylscBBu.js";import{a4 as e,a2 as u,a6 as a,a1 as C,a7 as M,aq as W,ar as n,a5 as s}from"../chunks/DQcMMISJ.js";import{h as x}from"../chunks/BMetjhqZ.js";import{s as h}from"../chunks/B7RjBHeQ.js";import{b as g}from"../chunks/DA96jJ6L.js";const S=!0,D=Object.freeze(Object.defineProperty({__proto__:null,prerender:S},Symbol.toStringTag,{value:"Module"}));var k=f('<meta name="description" content="Best practices for writing secure, precise IAM policies using validated ARNs — avoid common pitfalls and enforce least privilege."/> <meta property="og:title" content="Using the Parser in IAM Policies | ARN Parser Blog"/> <meta property="og:description" content="Best practices for writing secure, precise IAM policies using validated ARNs — avoid common pitfalls and enforce least privilege."/> <meta property="og:url"/> <meta property="og:type" content="article"/> <meta name="twitter:card" content="summary_large_image"/>',1),B=f('<div class="container fade-in post-layout svelte-1li990r"><div class="breadcrumbs svelte-1li990r"><a class="svelte-1li990r">Blog</a> <span>/</span> <p class="svelte-1li990r">Using the Parser in IAM Policies</p></div> <article class="prose svelte-1li990r"><h1 class="svelte-1li990r">Using the Parser in IAM Policies</h1> <p class="post-meta svelte-1li990r">Published: November 9, 2025</p> <p class="svelte-1li990r">IAM policies are only as secure as the ARNs they reference. A single typo or malformed ARN can grant unintended access — or break your application. This guide shows how to use the ARN Parser to write bulletproof policies.</p> <h2 class="svelte-1li990r">Why Validate ARNs in Policies?</h2> <p class="svelte-1li990r">AWS evaluates IAM policies at runtime. Invalid ARNs cause:</p> <ul class="svelte-1li990r"><li class="svelte-1li990r">Access denied errors (even with correct permissions)</li> <li class="svelte-1li990r">Overly broad access via wildcards</li> <li class="svelte-1li990r">Deployment failures in CI/CD</li></ul> <h3 class="svelte-1li990r">Common Policy Mistakes</h3> <pre class="svelte-1li990r"><code></code></pre> <h2 class="svelte-1li990r">Best Practices</h2> <h3 class="svelte-1li990r">1. Always Validate Before Apply</h3> <p class="svelte-1li990r">Paste every ARN into the parser. Green table = safe to use.</p> <h3 class="svelte-1li990r">2. Use Wildcards Strategically</h3> <pre class="svelte-1li990r"><code></code></pre> <h3 class="svelte-1li990r">3. Leverage CloudFormation Parameters</h3> <pre class="svelte-1li990r"><code></code></pre> <h3 class="svelte-1li990r">4. Cross-Account ARNs</h3> <p class="svelte-1li990r">For cross-account access:</p> <pre class="svelte-1li990r"><code></code></pre> <p class="svelte-1li990r">Validate both source and target account ARNs.</p> <h2 class="svelte-1li990r">Policy Testing Workflow</h2> <ol class="svelte-1li990r"><li class="svelte-1li990r">Write policy in JSON/YAML</li> <li class="svelte-1li990r">Extract all ARNs</li> <li class="svelte-1li990r">Paste into parser → confirm structure</li> <li class="svelte-1li990r">Apply via CLI or console</li></ol> <h2 class="svelte-1li990r">Real-World Example</h2> <p class="svelte-1li990r">Lambda function reading from S3:</p> <pre class="svelte-1li990r"><code></code></pre> <p class="svelte-1li990r">Parser confirms: service = s3, resourceType = bucket, resourceId = data-prod-2025/input/*.csv</p> <h2 class="svelte-1li990r">FAQ</h2> <details class="svelte-1li990r"><summary class="svelte-1li990r">Can I use variables in ARNs?</summary> <p class="svelte-1li990r">Yes, in CloudFormation/CDK. Always validate the final rendered ARN.</p></details> <details class="svelte-1li990r"><summary class="svelte-1li990r">Do principals need ARNs?</summary> <p class="svelte-1li990r">Yes for cross-account. Use <code>arn:aws:iam::123:role/X</code> in trust policies.</p></details> <details class="svelte-1li990r"><summary class="svelte-1li990r">What about condition keys?</summary> <p class="svelte-1li990r">Use <code>aws:ResourceTag/</code> with validated ARNs for tag-based access control.</p></details> <p class="italic-note svelte-1li990r">Never deploy an IAM policy without validating every ARN. One mistake = one breach.</p></article></div>');function j(A){var r=B();x("1li990r",P=>{var v=k(),I=a(C(v),6);n(4),u(()=>h(I,"content",`${g??""}/blog/posts/post5`)),M(()=>{W.title="Using the Parser in IAM Policies | ARN Parser Blog"}),m(P,v)});var l=e(r),y=e(l);n(4),s(l);var p=a(l,2),t=a(e(p),14),b=e(t);b.textContent=`// Wrong: Missing colon
"Resource": "arn:aws:s3::my-bucket"

// Wrong: Typos in service
"Resource": "arn:aws:ec3:us-east-1:123:instance/i-abc"

// Wrong: Hardcoded account
"Resource": "arn:aws:s3:::my-bucket" in shared templates`,s(t);var i=a(t,10),R=e(i);R.textContent=`// Good: Limit to prefix
"Resource": "arn:aws:s3:::prod-logs/app1/*"

// Bad: Too broad
"Resource": "*"`,s(i);var o=a(i,4),w=e(o);w.textContent='Resource: !Sub "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:${FunctionName}"',s(o);var c=a(o,6),N=e(c);N.textContent='"Resource": "arn:aws:iam::456789012345:root"',s(c);var d=a(c,12),_=e(d);_.textContent=`{
  "Effect": "Allow",
  "Action": ["s3:GetObject"],
  "Resource": "arn:aws:s3:::data-prod-2025/input/*.csv"
}`,s(d),n(12),s(p),s(r),u(()=>h(y,"href",`${g??""}/blog`)),m(A,r)}export{j as component,D as universal};
